<div class="ng-wig">
  <ul class="nw-toolbar">
    @for (button of toolbarButtons; let i = $index; track button) {
    <li class="nw-toolbar__item">
      @if (button.children) {
      <div
        class="nwe-dropdown"
        (mouseenter)="button.isOpenOnMouseOver?button.visibleDropdown = true:true"
        (mouseleave)="button.isOpenOnMouseOver?button.visibleDropdown = false:true"
          (click)="onDropdownButtonSelected(button, $event)"
        (keydown.enter)="onDropdownButtonSelected(button, $event)"
      >
        <button
          #toolbarButton
          type="button"
          class="nw-button"
          [ngClass]="[button.styleClass]"
          [title]="button.title"
          [disabled]="disabled"
          [attr.tabindex]="toolbarButtonIndex === i ? 0 : -1"
          (focus)="toolbarButtonIndex = i"
          (keydown)="onToolbarKeydown($event, i)"
          [attr.aria-label]="button.ariaLabel || button.title || button.label"
        >
          @if (button.icon) {
          <div class="nwe-icon" [ngClass]="[button.icon]" aria-hidden="true" [attr.focusable]="false"></div>
          } @else {<!--
             -->{{ button.label }}<!--
          -->}
        </button>
        <div
          class="nwe-dropdown-content"
          [ngClass]="button.visibleDropdown ? 'nwe-show' : ''"
        >
          @for (child of button.children; let j = $index; track child) {
          <a href="#">
            <button
              type="button"
              class="nw-button"
              [ngClass]="[child.styleClass]"
              [title]="child.title"
              (click)="execCommand(child.command); closeDropdown(button)"
              [disabled]="disabled"
              [attr.tabindex]="button.visibleDropdown && button.dropdownButtonIndex === j ? 0 : -1"
              (focus)="button.dropdownButtonIndex = j"
              (keydown)="onDropdownKeydown($event, button)"
              [attr.aria-label]="child.ariaLabel || child.title || child.label"
            >
              @if (child.icon) {
              <div class="nwe-icon" [ngClass]="[child.icon]" aria-hidden="true" [attr.focusable]="false"></div>
              } @else {<!--
                -->{{ child.label }}<!--
              -->}
            </button>
          </a>
          }
        </div>
      </div>
      } @else {
      <div>
        <button
          #toolbarButton
          type="button"
          class="nw-button"
          [ngClass]="[button.styleClass]"
          [title]="button.title"
          (click)="execCommand(button.command)"
          [disabled]="disabled"
          [attr.tabindex]="toolbarButtonIndex === i ? 0 : -1"
          (focus)="toolbarButtonIndex = i"
          (keydown)="onToolbarKeydown($event, i)"
          [attr.aria-label]="button.ariaLabel || button.title || button.label"
        >
          @if (button.icon) {
          <div class="nwe-icon" [ngClass]="[button.icon]" aria-hidden="true" [attr.focusable]="false"></div>
          } @else {<!--
              -->{{ button.label }}<!--
          -->}
        </button>
      </div>
      }
    </li>
    }
  </ul>

  <div
    class="nw-editor-container"
    (click)="container.focus()"
    (keydown.enter)="container.focus()"
    [ngClass]="{ 'nw-editor-container--with-toolbar': toolbarButtons.length }"
  >
    @if (editMode) {
    <div class="nw-editor__src-container">
      <textarea
        [ngModel]="content"
        (ngModelChange)="onTextareaChange($event)"
        (blur)="propagateTouched()"
        class="nw-editor__src"
      >
      </textarea>
    </div>
    }
    <div
      class="nw-editor"
      [ngClass]="{ 'nw-disabled': disabled,'nw-invisible': editMode }"
    >
      @if (shouldShowPlaceholder()) {
      <div class="nw-editor__placeholder" [innerText]="placeholder"></div>
      }
      <div
        #ngWigEditable
        class="nw-editor__res"
        role="textbox"
        aria-multiline="true"
        [attr.contenteditable]="!disabled"
        [ngClass]="{ disabled: disabled}"
        (paste)="onPaste($event)"
        (focus)="hasFocus = true"
        (blur)="onBlur()"
        (input)="onContentChange(ngWigEditable.innerHTML)"
      >
        <!--
      --></div>
    </div>
  </div>
</div>
